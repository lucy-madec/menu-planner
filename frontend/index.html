<!DOCTYPE html>
<html lang="fr">
<head>
  <meta charset="UTF-8">
  <title>Planificateur de menus</title>
</head>
<body>
  <h1>üçΩÔ∏è Planificateur de menus</h1>

  <form id="menu-form">
    <label for="day">Jour :</label>
    <select id="day" required>
      <option value="">--Choisir--</option>
      <option>Lundi</option>
      <option>Mardi</option>
      <option>Mercredi</option>
      <option>Jeudi</option>
      <option>Vendredi</option>
      <option>Samedi</option>
      <option>Dimanche</option>
    </select>
    <br>

    <label for="meal">Repas :</label>
    <input type="text" id="meal" required>
    <br>

    <label for="ingredients">Ingr√©dients (s√©par√©s par des virgules) :</label>
    <input type="text" id="ingredients">
    <br>

    <button type="submit">Ajouter</button>
  </form>

  <h2>üßæ Menus enregistr√©s</h2>
  <ul id="menu-list"></ul>

  <script>
    const apiUrl = "http://localhost:5000/api/menus";

    async function fetchMenus() {
      const res = await fetch(apiUrl);
      const menus = await res.json();
      const list = document.getElementById("menu-list");
      list.innerHTML = "";

      menus.forEach(menu => {
        const li = document.createElement("li");
        li.textContent = `${menu.day} : ${menu.meal} (${menu.ingredients.join(", ")})`;
        const del = document.createElement("button");
        del.textContent = "‚ùå";
        del.onclick = async () => {
          await fetch(`${apiUrl}/${menu._id}`, { method: "DELETE" });
          fetchMenus();
        };
        li.appendChild(del);
        list.appendChild(li);
      });
    }

    document.getElementById("menu-form").addEventListener("submit", async (e) => {
      e.preventDefault();
      const day = document.getElementById("day").value;
      const meal = document.getElementById("meal").value;
      const ingredients = document.getElementById("ingredients").value.split(',').map(i => i.trim());

      await fetch(apiUrl, {
        method: "POST",
        headers: { "Content-Type": "application/json" },
        body: JSON.stringify({ day, meal, ingredients })
      });

      e.target.reset();
      fetchMenus();
    });

    fetchMenus();
  </script>
</body>
</html>
